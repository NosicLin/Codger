<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>虚拟机</TITLE>
<META NAME="description" CONTENT="虚拟机">
<META NAME="keywords" CONTENT="index">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="index.css">

<LINK REL="next" HREF="node93.html">
<LINK REL="previous" HREF="node61.html">
<LINK REL="up" HREF="index.html">
<LINK REL="next" HREF="node88.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html1060"
  HREF="node88.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html1058"
  HREF="index.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html1052"
  HREF="node86.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html1061"
  HREF="node88.html">模块对象</A>
<B> Up:</B> <A NAME="tex2html1059"
  HREF="index.html">index</A>
<B> Previous:</B> <A NAME="tex2html1053"
  HREF="node86.html">export语句</A>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00080000000000000000">
虚拟机</A>
</H1>
Codger解析器整体大的框架可以分为两部分：解析器前端和解析器后端。解析器前端负责检查源程序中词法、语法是否正确，并且把源程序转换成与之等价的模块对象，模块对象中有源程序中出现的常量，标识符，以及转换后的字节码等信息，解析器后端负责根据模块对象的字节码来运行。解析器后端也被称为虚拟机，虚拟机由：模块管理，栈帧管理，异常处理，内存管理，数据栈管理几个子模块构成。

<P>
在Codger中每个虚拟机实例用EgThread来表示(如图<A HREF="#fig:eg_thread"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="/usr/share/latex2html/icons/crossref.png"></A>)，EgThread是一个线程对象，EgThread可以创建多个，现在Codger还不支持并发运行多个线程对象，但可以模拟并发，让线程对象轮流的以串行的方式执行，一个线程对象执行一定数量的字节码后，放弃CPU，然后调度另一个线程对象。

<DIV ALIGN="CENTER"><A NAME="fig:eg_thread"></A><A NAME="1137"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure:</STRONG>
线程对象的结构</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>[scale=0.5]EgThread.png</TD></TR>
</TABLE>
</DIV>

<P>
每当一个线程对象被创建时，它将会得到自己的pc寄存器，sp 寄存器，一个数据栈，以及一个Codger栈。寄存器pc的值总是会指向下一条执行的字节码；数据栈用于保存在计算过程中的临时对象和操作数；寄存器sp总是指向数据栈的栈顶；Codger栈总是存储Codger方法的调用状态，包括它被调用时传进来的参数值，它的返回值，局部变量等。

<P>
Codger方法指该方法在Codger源程序定义方法，如果一个方法调用是用c语言实现的，那么该方法被称为本地方法。Codger栈是由许多栈帧组成，一个栈帧包括一个Codger方法调用状态，当调用一个Codger方法时，会将一个新的帧栈压入到Codger栈中，当方法返回时，这个栈帧会作Codger栈中弹出并抛弃。
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html1062"
  HREF="node88.html">模块对象</A>
<LI><A NAME="tex2html1063"
  HREF="node89.html">数据栈</A>
<LI><A NAME="tex2html1064"
  HREF="node90.html">栈帧</A>
<LI><A NAME="tex2html1065"
  HREF="node91.html">异常处理</A>
<LI><A NAME="tex2html1066"
  HREF="node92.html">字节码</A>
</UL>
<!--End of Table of Child-Links-->
<BR><HR>
<ADDRESS>
NosicLin
2012-06-03
</ADDRESS>
</BODY>
</HTML>
